→ 정밀도, 재현율, F1-점수, 매튜 상관 계수

### 오차 행렬

**오차 행렬(confusion matrix)**이란 학습 알고리즘의 성능을 행렬로 펼쳐 놓은 것.

- 진짜 양성(True Positive, TP) → 예측 클래스 T, 실제 클래스 T
- 진짜 음성(True Negative, TN) → 예측 클래스 F, 실제 클래스 F
- 거짓 양성(False Positive, FP) → 예측 클래스 T, 실제 클래스 F
- 거짓 음성(False Negative, FN) → 예측 클래스 F, 실제 클래스 T

### 예측 오차와 정확도

**예측 오차(ERR)**는 잘못된 예측의 합을 전체 예측 샘플 개수로 나눈 것.

$$
ERR = \frac {FP + FN} {FP + FN + TP + TN}
$$

**정확도(ACC)**는 옳은 예측의 합을 전체 예측 샘플 개수로 나눈 것.

$$
ACC = \frac {TP + TN} {FP + FN + TP + TN} = 1 - ERR
$$
### 거짓 양성 비율과 진짜 양성 비율

**거짓 양성 비율(False Positive Rate, FPR)**과 **진짜 양성 비율(True Positive Rate, TPR)**은 클래스 비율이 다른 경우 유용한 성능 지표이다. → 실제 클래스끼리 계산하기 때문에 클래스 비율에 영향을 받지 않음.

$$
FPR = \frac {FP} {N} = \frac {FP} {FP + TN}
$$

$$
TPR = \frac {TP} {P} = \frac {TP} {FN + TP}
$$

### 정밀도와 재현율, F1-Score

**재현율(Recall, REC)**는 관련된 샘플(양성)을 얼마나 많이 올바르게(진짜 양성으로) 감지했는지를 정량화한다.
→ REC는 TPR의 다른 이름이다.

$$
REC = TPR = \frac {TP} {FN + TP}
$$


**정밀도(Precision, PRE)**는 예측된 샘플(진짜 양성과 거짓 양성의 합) 중 실제로 관련된 샘플(진짜 양성)의 수를 정량화 한다.

$$
PRE = \frac {TP} {TP + FP}
$$

재현율(REC)을 최적화하면 FP가 높아지고 정밀도(PRE)를 최적화하면 FN이 높아진다.


PRE와 REC의 최적화로 인한 장단점의 균형을 맞추기 위해 **PRE와 REC의 조화 평균**인 **F1-Score**를 자주 사용한다.

$$
F1 = 2 \frac {PRE \times REC} {PRE + REC}
$$

---

- **재현율 최적화와 FP 증가**

재현율은 실제 긍정 사례 중에서 **모델이 올바르게 긍정으로 예측한 비율(TP)**이다.

따라서 재현율을 높이려면 실제 긍정인 것을 높치지 않고 최대한 많이 찾아내야 한다. (FN을 줄인다)

이를 위해 모델은 **긍정으로 예측하는 기준(임계값)을 낮춘다**.

임계값을 낮추면 실제 긍정인 데이터를 긍정으로 더 쉽게 분류하게 되므로 TP는 증가하고 FN은 감소한다.
하지만 임계값을 낮추면 실제로는 부정인데 모델이 긍정으로 잘못 분류하는 FP도 함께 증가하게 된다.

즉, **놓치지 않기 위해** 긍정 예측의 문턱을 낮추면 원치 않는 **오탐**도 늘어나게 된다.

암 진단과 같이 FN(암인데 암이 아니라고 판단)이 치명적인 경우에 재현율이 우선시 된다.

- **정밀도 최적화와 FN 증가**

정밀도는 모델이 긍정으로 예측한 사례 중에서 **실제로 긍정인 비율**이다.

따라서 정밀도를 높이려면 모델이 긍정으로 예측한 것들이 정말로 긍정이어야 한다. (FP를 줄인다)

이를 위해 모델은 **긍정으로 예측하는 기준을 높인다.**

임계값을 높이면 실제로는 부정인데 긍정으로 잘못 분류하는 경우(FP)가 줄어들게 되므로 정밀도가 높아진다.
하지만 임계값을 높이면 실제로는 긍정인데 모델이 부정으로 잘못 분류하는 FN도 함께 증가하게 된다.

즉, **오탐을 줄이기 위해** 긍정 예측의 문턱을 높이면 실제로 긍정인데 **놓치게 되는 경우**도 늘어나게 된다.

스팸 메일 분류와 같이 정상 메일을 스팸으로 오분류(FP)하는 것이 더 큰 문제인 경우에 정밀도를 우선시한다.

---

### 매튜 상관 계수 (Matthews Correlation Coefficient, MCC)

$$
MCC = \frac
{TP \times TN - FP \times FN}
{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}
$$

